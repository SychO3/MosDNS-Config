plugins:
  ################ DNS #################
  # google-dns
  - tag: google
    type: forward
    args:
      concurrent: 3
      upstreams:
        ## DOH - ipv4
        - addr: "https://dns.google/dns-query"
          dial_addr: "8.8.4.4"
        - addr: "https://dns.google/dns-query"
          dial_addr: "8.8.8.8"

        ## DOH - ipv6
        ### 同时使用 NAT64 地址和 Google 公共 DNS IPv6 解析器地址（2001:4860:4860::8888 或 2001:4860:4860::8844）是不可行的，
        ### 因为其中任一项的否定响应不会重新查询。您必须为所有查询选择 IPv6 或 IPv4 DNS 解析
        # - addr: "https://dns.google/dns-query"
        #   dial_addr: "2001:4860:4860::6464"
        # - addr: "https://dns.google/dns-query"
        #   dial_addr: "2001:4860:4860::0064"
        - addr: "https://dns.google/dns-query"
          dial_addr: "2001:4860:4860::8844"
        - addr: "https://dns.google/dns-query"
          dial_addr: "2001:4860:4860::8888"

        ## DoT - ipv4
        - addr: "tls://dns.google"
          dial_addr: "8.8.4.4"
          enable_pipeline: true
        - addr: "tls://dns.google"
          dial_addr: "8.8.8.8"
          enable_pipeline: true

        ## DoT - ipv6
        - addr: "tls://dns.google"
          dial_addr: "2001:4860:4860::8844"
          enable_pipeline: true
        - addr: "tls://dns.google"
          dial_addr: "2001:4860:4860::8888"
          enable_pipeline: true


        ## DoH3 - ipv4
        - addr: "https://dns.google/dns-query"
          dial_addr: "8.8.4.4"
          enable_http3: true
        - addr: "https://dns.google/dns-query"
          dial_addr: "8.8.8.8"
          enable_http3: true

        ## DoH3 - ipv6
        - addr: "https://dns.google/dns-query"
          dial_addr: "2001:4860:4860::8844"
          enable_http3: true
        - addr: "https://dns.google/dns-query"
          dial_addr: "2001:4860:4860::8888"
          enable_http3: true


  # cloudflare-dns
  - tag: cloudflare
    type: forward
    args:
      concurrent: 3
      upstreams:
        ## DoH - ipv4
        - addr: "https://cloudflare-dns.com/dns-query"
          dial_addr: "1.1.1.1"
        - addr: "https://cloudflare-dns.com/dns-query"
          dial_addr: "1.0.0.1"

        ## DoH - ipv6
        - addr: "https://dns.cloudflare.com/dns-query"
          dial_addr: "2606:4700:4700::1111"
        - addr: "https://dns.cloudflare.com/dns-query"
          dial_addr: "2606:4700:4700::1001"

        ## DoT - ipv4
        - addr: "tls://one.one.one.one"
          dial_addr: "1.1.1.1"
          enable_pipeline: true
        - addr: "tls://one.one.one.one"
          dial_addr: "1.0.0.1"
          enable_pipeline: true

        ## DoT - ipv6
        - addr: "tls://one.one.one.one"
          dial_addr: "2606:4700:4700::1111"
          enable_pipeline: true
        - addr: "tls://one.one.one.one"
          dial_addr: "2606:4700:4700::1001"
          enable_pipeline: true

        ## DoH3 - ipv4
        - addr: "https://cloudflare-dns.com/dns-query"
          dial_addr: "1.1.1.1"
          enable_http3: true
        - addr: "https://cloudflare-dns.com/dns-query"
          dial_addr: "1.0.0.1"
          enable_http3: true

        ## DoH3 - ipv6
        - addr: "https://cloudflare-dns.com/dns-query"
          dial_addr: "2606:4700:4700::1111"
          enable_http3: true
        - addr: "https://cloudflare-dns.com/dns-query"
          dial_addr: "2606:4700:4700::1001"
          enable_http3: true


  # nextdns
  - tag: nextdns
    type: forward
    args:
      concurrent: 2
      upstreams:
        - addr: "https://dns.nextdns.io"
          dial_addr: "45.90.28.186"
          enable_http3: true
        - addr: "https://dns.nextdns.io"
          dial_addr: "2a07:a8c0::ae:d5cb"
          enable_http3: true

        - addr: "tls://dns.nextdns.io"
          enable_pipeline: true
          dial_addr: "45.90.28.186"


  # quad9-dns
  - tag: quad9
    type: forward
    args:
      concurrent: 2
      upstreams:
        ## DoH - ipv4
        - addr: "https://dns11.quad9.net/dns-query"
          dial_addr: "9.9.9.11"
        - addr: "https://dns11.quad9.net/dns-query"
          dial_addr: "149.112.112.11"

        ## DoH - ipv6
        - addr: "https://dns11.quad9.net/dns-query"
          dial_addr: "2620:fe::11"
        - addr: "https://dns11.quad9.net/dns-query"
          dial_addr: "2620:fe::fe:11"

        ## DoT - ipv4
        - addr: "tls://dns11.quad9.net"
          dial_addr: "9.9.9.11"
          enable_pipeline: true
        - addr: "tls://dns11.quad9.net"
          dial_addr: "149.112.112.11"
          enable_pipeline: true

        ## DoT - ipv6
        - addr: "tls://dns11.quad9.net"
          dial_addr: "2620:fe::11"
          enable_pipeline: true
        - addr: "tls://dns11.quad9.net"
          dial_addr: "2620:fe::fe:11"
          enable_pipeline: true


  - tag: forward_remote
    type: forward
    args:
      concurrent: 1
      upstreams:
        - addr: 127.0.0.1:7874 

  # ali-dns
  - tag: ali
    type: forward
    args:
      concurrent: 3
      upstreams:
        ## DoH - ipv4
        - addr: "https://dns.alidns.com/dns-query"
          dial_addr: "223.5.5.5"
        - addr: "https://dns.alidns.com/dns-query"
          dial_addr: "223.6.6.6"

        ## DoH - ipv6
        - addr: "https://dns.alidns.com/dns-query"
          dial_addr: "2400:3200::1"
        - addr: "https://dns.alidns.com/dns-query"
          dial_addr: "2400:3200:baba::1"

        ## DoT - ipv4
        - addr: "tls://dns.alidns.com"
          dial_addr: "223.5.5.5"
          # enable_pipeline: true # 不支持
        - addr: "tls://dns.alidns.com"
          dial_addr: "223.6.6.6"
          # enable_pipeline: true # 不支持

        ## DoT - ipv6
        - addr: "tls://dns.alidns.com"
          dial_addr: "2400:3200::1"
          # enable_pipeline: true # 不支持
        - addr: "tls://dns.alidns.com"
          dial_addr: "2400:3200:baba::1"
          # enable_pipeline: true # 不支持

        ## DoH3 - ipv4
        - addr: "https://dns.alidns.com/dns-query"
          dial_addr: "223.5.5.5"
          enable_http3: true
        - addr: "https://dns.alidns.com/dns-query"
          dial_addr: "223.6.6.6"
          enable_http3: true

        ## DoH3 - ipv6
        - addr: "https://dns.alidns.com/dns-query"
          dial_addr: "2400:3200::1"
          enable_http3: true
        - addr: "https://dns.alidns.com/dns-query"
          dial_addr: "2400:3200:baba::1"
          enable_http3: true


  # dnspod-dns
  - tag: dnspod
    type: forward
    args:
      concurrent: 3
      upstreams:
        ## DoH - ipv4
        - addr: "https://doh.pub/dns-query"
          dial_addr: "119.29.29.29"

        ## DoH - ipv6
        - addr: "https://doh.pub/dns-query"
          dial_addr: "2402:4e00:1::"
        - addr: "https://doh.pub/dns-query"
          dial_addr: "2402:4e00::"

        ## DoT - ipv4
        - addr: "tls://dot.pub"
          dial_addr: "119.29.29.29"
          enable_pipeline: true

        ## DoT - ipv6
        - addr: "tls://dot.pub"
          dial_addr: "2402:4e00:1::"
          enable_pipeline: true
        - addr: "tls://dot.pub"
          dial_addr: "2402:4e00::"
          enable_pipeline: true


  # local dns
  - tag: local
    type: forward
    args:
      concurrent: 1
      upstreams:
        - addr: "udp://127.0.0.1:53"

  # server 失败
  - tag: reject_2
    type: sequence
    args:
      - exec: reject 2

  # 拒绝响应
  - tag: reject_3
    type: sequence
    args:
      - exec: reject 3

  # 不支持的操作
  - tag: reject_5
    type: sequence
    args:
      - exec: reject 5
